@using System.Globalization
@model GudSafe.Data.ViewModels.GalleryViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = @Model.Username + "'s Gallery";
    Layout = "_Layout";
}
<div class="text-center">
    <div class="row">

        @{
            foreach (var file in Model?.Files)
            {
                <div class="col-lg-4 col-md-12 mb-4 " id="@file.UniqueId">
                    <div class="uploadBox">
                        <a href="@Context.Request.Scheme://@Context.Request.Host/files/@file.UniqueId">
                            <img class="upload" src="@Context.Request.Scheme://@Context.Request.Host/files/@file.UniqueId/thumbnail"/>
                        </a>
                    </div>

                    <div class="align-self-end">
                        <p>@file.CreationTime.ToString("f", new CultureInfo("en-us"))</p>
                        <hr/>
                        <form class="align-self-end">
                            <button class="btn btn-danger align-self-end" type="button" onclick="deleteFile('@file.UniqueId.ToString()')">Delete</button>
                        </form>
                    </div>
                </div>
            }
        }

    </div>
</div>

@section Scripts
{
    <script>
        function deleteFile(id) {
            $.ajax({
                url: "@Url.Action("DeleteFile")",
                type: "POST",
                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
                data: {id: id},
                success: function (result) {
                    if (result.success) {
                        $("#" + id).remove();
                    }
                }
            });
        }
    </script>
}